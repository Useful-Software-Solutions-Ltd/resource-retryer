!function(){"use strict";function e(e,n,o){function i(r,t,n,o){if(o&&o.retry){var i=angular.extend({},l,o.retry);a(i);var u=e(r,t,n,o),g=n?c.concat(Object.getOwnPropertyNames(n)):c;return s(u,g,i),u}return e(r,t,n,o)}function s(e,r,t){r.forEach(function(r){u(e,r,t)})}function u(e,a,i){function s(s,l,g,f){function m(){var r=t(i,c);u.apply(e,d.args).$promise.then(function(r){v.$resolved=!0,angular.extend(v,r),p.resolve(v),d.onResolve&&d.onResolve.apply(e,[v])},function(t){v.$resolved=!0,c<i.retries?(c+=1,angular.isFunction(i.retryCallback)&&i.retryCallback(t,c),o(function(){m()},r)):(angular.extend(v,t),p.reject(v),d.onReject&&d.onReject.apply(e,[v]))})}var d=r(a,arguments),p=n.defer(),v={$promise:p.promise,$resolved:!1};return m(),v}var u=e[a],c=0;e[a]=s}var c=["get","save","query","remove","delete"],l={strategy:"progressiveBackSOff",minWait:50,maxWait:500,retries:5,base:2,startSequenceAfter:1};return i}function r(e,r){var t,a,n,o=/^(POST|PUT|PATCH)$/i.test(e),i={},s={};switch(r.length){case 4:a=r[3],n=r[2];case 3:case 2:if(!angular.isFunction(r[1])){i=r[0],t=r[1],n=r[2];break}if(angular.isFunction(r[0])){n=r[0],a=r[1];break}n=r[1],a=r[2];case 1:angular.isFunction(r[0])?n=r[0]:o?t=r[0]:i=r[0];break;case 0:break;default:throw{code:"badargs",message:"Expected up to 4 arguments [params, data, success, error], got {0} arguments"+r.length}}return s.onResolve=angular.isFunction(n)?n:null,s.onReject=angular.isFunction(a)?a:null,s.args=[i],t&&s.args.push(t),s}function t(e,r){if("custom"===e.strategy)return e.delayCalculator(e,r);if("randomizedRetry"===e.strategy)return Math.floor(Math.random()*(e.maxWait-e.minWait+1))+e.minWait;if("progressiveBackOff"===e.strategy){var t=r+(e.startSequenceAfter-1),a=Math.pow(e.base,t);return a<e.minWait?e.minWait:a>e.maxWait?e.maxWait:a}}function a(e){if(e.strategy&&o.indexOf(e.strategy)<0)throw{name:"error",message:"Unknown retry approach. Acceptable options are: "+o.toString()}}var n=angular.module("resourceRetryer",["ngResource"]),o=["randomizedRetry","progressiveBackOff","custom"];n.config(["$provide",function(r){r.decorator("$resource",["$delegate","$q","$timeout",e])}])}();